/** @license sf2synth.js 2013 - imaya / GREE Inc. [ https://github.com/gree/sf2synth.js ], 2013-2018 - Logue [ https://github.com/logue/sf2synth.js ] The MIT License */(function() {'use strict';var g,n="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},u="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function x(a){if(a){for(var b=u,c=["Array","prototype","includes"],d=0;d<c.length-1;d++){var e=c[d];e in b||(b[e]={});b=b[e]}c=c[c.length-1];d=b[c];a=a(d);a!=d&&null!=a&&n(b,c,{configurable:!0,writable:!0,value:a})}}
x(function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var e=b.length;c=c||0;for(0>c&&(c=Math.max(c+e,0));c<e;c++){var f=b[c];if(f===a||Object.is(f,a))return!0}return!1}});var y=this;
function C(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function D(a,b){a=a.split(".");var c=y;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c=c[d]&&c[d]!==Object.prototype[d]?c[d]:c[d]={}:c[d]=b};function E(a,b,c){this.b=a;this.destination=b;this.h=c;this.channel=c.channel;this.key=c.key;this.vc=c.velocity;this.buffer=c.sample;this.playbackRate=c.basePlaybackRate;this.loopStart=c.loopStart;this.loopEnd=c.loopEnd;this.sampleRate=c.sampleRate;this.volume=c.volume;this.Pb=c.panpot;this.H=c.pitchBend;this.I=c.pitchBendSensitivity;this.Lb=c.modEnvToPitch;this.A=c.expression;this.ga=c.cutOffFrequency;this.startTime=a.currentTime;this.fa=this.playbackRate|0;this.Ta=!1}g=E.prototype;
g.noteOn=function(){var a=this.b,b=this.h,c=this.buffer,d=this.b.currentTime,e=d+b.volDelay,f=d+b.modDelay,h=e+b.volAttack+b.volHold,k=e+b.modAttack+b.modHold,l=h+b.volDecay,m=k+b.modDecay;var p=b.loopStart/this.sampleRate;var v=b.loopEnd/this.sampleRate;var w=b.start/this.sampleRate;var r=void 0!==b.pan?b.pan:this.Pb;c=c.subarray(0,c.length+b.end);var q=this.kb=a.createBuffer(1,c.length,this.sampleRate);q.getChannelData(0).set(c);c=this.Ca=a.createBufferSource();c.buffer=q;c.loop=b.sampleModes;c.loopStart=
p;c.loopEnd=v;this.cb(this.H);p=this.ia=a.createGain();v=p.gain;this.O=a.createGain();this.O.gain.setTargetAtTime(this.A/127,this.b.currentTime,.015);q=a.createPanner();q.panningModel="equalpower";q.setPosition(Math.sin(r*Math.PI/2),0,Math.cos(r*Math.PI/2));r=this.vc/127*this.volume*(1-b.initialAttenuation/1E3);0>r&&(r=0);v.setValueAtTime(0,d).setValueAtTime(0,e).setTargetAtTime(r,e,b.volAttack).setValueAtTime(r,h).linearRampToValueAtTime(r*(1-b.volSustain),l);e=this.K(b.initialFilterFc);h=this.K(b.initialFilterFc+
b.modEnvToFilterFc);l=e+(h-e)*(1-b.modSustain);a=this.i=a.createBiquadFilter();a.Q.setValueAtTime(Math.pow(10,b.initialFilterQ/200),d);a.frequency.setTargetAtTime(e/127,this.b.currentTime,.5);a.type="lowpass";a.frequency.setValueAtTime(e,d).setValueAtTime(e,f).setTargetAtTime(h,f,parseFloat(b.modAttack+1)).setValueAtTime(h,k).linearRampToValueAtTime(l,m);c.connect(a);a.connect(q);q.connect(this.O);this.O.connect(p);b.mute||this.connect();c.start(0,w)};
g.K=function(a){return 440*Math.pow(2,(a-6900)/1200)};g.noteOff=function(){this.Ta=!0};
g.release=function(){var a=this.h,b=this.Ca,c=this.ia,d=this.b.currentTime,e=a.releaseTime-64;e=d+a.volRelease*c.gain.value*(1+e/(0>e?64:63));var f=this.i,h=this.K(a.initialFilterFc),k=this.K(a.initialFilterFc+a.modEnvToFilterFc);k=d+a.modRelease*(h===k?1:(f.frequency.value-h)/(k-h));if(this.kb)switch(a.sampleModes){case 1:c.gain.cancelScheduledValues(0);c.gain.setValueAtTime(c.gain.value,d);c.gain.linearRampToValueAtTime(0,e);f.frequency.cancelScheduledValues(0);f.frequency.setValueAtTime(f.frequency.value,
d);f.frequency.linearRampToValueAtTime(h,k);b.playbackRate.cancelScheduledValues(0);b.playbackRate.setValueAtTime(b.playbackRate.value,d);b.playbackRate.linearRampToValueAtTime(this.fa,k);b.stop(e);break;case 2:y.console.log("detect unused sampleModes");break;case 3:b.loop=!1}};g.connect=function(){this.ia.connect(this.destination)};g.disconnect=function(){this.ia.disconnect(0)};
g.oc=function(){var a=this.Ca.playbackRate,b=this.fa,c=this.startTime,d=this.h,e=c+d.modAttack,f=e+d.modDecay,h=b*Math.pow(Math.pow(2,1/12),this.Lb*this.h.scaleTuning);a.cancelScheduledValues(0);a.setValueAtTime(b,c);a.linearRampToValueAtTime(h,e);a.linearRampToValueAtTime(b+(h-b)*(1-d.modSustain),f)};g.uc=function(a){this.O.gain.setTargetAtTime((this.A=a)/127,this.b.currentTime,.015)};
g.cb=function(a){this.fa=this.playbackRate*Math.pow(Math.pow(2,1/12),a/(0>a?8192:8191)*this.I*this.h.scaleTuning);this.oc()};function F(a,b){b=b||{};this.input=a;this.C=b.index||0;this.length=b.length||a.length-this.C;this.offset=this.C;this.padding=void 0!==b.padding?b.padding:!0;this.mb=void 0!==b.bigEndian?b.bigEndian:!1}function G(a,b,c){this.type=a;this.size=b;this.offset=c}F.prototype.parse=function(){var a=this.length+this.offset;for(this.s=[];this.C<a;)this.Qb()};
F.prototype.Qb=function(){var a=this.input,b=this.C;this.s.push(new G(String.fromCharCode(a[b++],a[b++],a[b++],a[b++]),a=this.mb?(a[b++]<<24|a[b++]<<16|a[b++]<<8|a[b++])>>>0:(a[b++]|a[b++]<<8|a[b++]<<16|a[b++]<<24)>>>0,b));b+=a;this.padding&&1===(b-this.offset&1)&&b++;this.C=b};F.prototype.c=function(a){a=this.s[a];return void 0===a?null:a};function H(a,b){b=b||{};this.input=a;this.dc=b.parserOption;this.sampleRate=b.sampleRate||22050}g=H.prototype;g.parse=function(){var a=new F(this.input,this.dc);a.parse();if(1!==a.s.length)throw Error("wrong chunk length");a=a.c(0);if(null===a)throw Error("chunk not found");this.ac(a);this.input=null};
g.ac=function(a){var b=this.input,c=a.offset;if("RIFF"!==a.type)throw Error("invalid chunk type:"+a.type);var d=String.fromCharCode(b[c++],b[c++],b[c++],b[c++]);if("sfbk"!==d)throw Error("invalid signature:"+d);a=new F(b,{index:c,length:a.size-4});a.parse();if(3!==a.s.length)throw Error("invalid sfbk structure");this.Ub(a.c(0));this.bc(a.c(1));this.Xb(a.c(2))};
g.Ub=function(a){var b=this.input,c=a.offset;if("LIST"!==a.type)throw Error("invalid chunk type:"+a.type);var d=String.fromCharCode(b[c++],b[c++],b[c++],b[c++]);if("INFO"!==d)throw Error("invalid signature:"+d);(new F(b,{index:c,length:a.size-4})).parse()};
g.bc=function(a){var b=this.input,c=a.offset;if("LIST"!==a.type)throw Error("invalid chunk type:"+a.type);var d=String.fromCharCode(b[c++],b[c++],b[c++],b[c++]);if("sdta"!==d)throw Error("invalid signature:"+d);a=new F(b,{index:c,length:a.size-4});a.parse();if(1!==a.s.length)throw Error("TODO");this.bb=a.c(0)};
g.Xb=function(a){var b=this.input,c=a.offset;if("LIST"!==a.type)throw Error("invalid chunk type:"+a.type);var d=String.fromCharCode(b[c++],b[c++],b[c++],b[c++]);if("pdta"!==d)throw Error("invalid signature:"+d);a=new F(b,{index:c,length:a.size-4});a.parse();if(9!==a.s.length)throw Error("invalid pdta chunk");this.Zb(a.c(0));this.Wb(a.c(1));this.$b(a.c(2));this.Yb(a.c(3));this.Vb(a.c(4));this.Rb(a.c(5));this.Tb(a.c(6));this.Sb(a.c(7));this.cc(a.c(8))};
g.Zb=function(a){var b=this.input,c=a.offset,d=this.gc=[],e=a.offset+a.size;if("phdr"!==a.type)throw Error("invalid chunk type:"+a.type);for(;c<e;)d.push({hc:String.fromCharCode.apply(null,b.subarray(c,c+=20)),fc:b[c++]|b[c++]<<8,za:b[c++]|b[c++]<<8,Xa:b[c++]|b[c++]<<8,yc:(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0,xc:(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0,zc:(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0})};
g.Wb=function(a){var b=this.input,c=a.offset,d=this.ic=[],e=a.offset+a.size;if("pbag"!==a.type)throw Error("invalid chunk type:"+a.type);for(;c<e;)d.push({Ya:b[c++]|b[c++]<<8,oa:b[c++]|b[c++]<<8})};g.$b=function(a){if("pmod"!==a.type)throw Error("invalid chunk type:"+a.type);this.$a=this.Wa(a)};g.Yb=function(a){if("pgen"!==a.type)throw Error("invalid chunk type:"+a.type);this.Za=this.Va(a)};
g.Vb=function(a){var b=this.input,c=a.offset,d=this.h=[],e=a.offset+a.size;if("inst"!==a.type)throw Error("invalid chunk type:"+a.type);for(;c<e;)d.push({Hb:String.fromCharCode.apply(null,b.subarray(c,c+=20)),Oa:b[c++]|b[c++]<<8})};g.Rb=function(a){var b=this.input,c=a.offset,d=this.Ib=[],e=a.offset+a.size;if("ibag"!==a.type)throw Error("invalid chunk type:"+a.type);for(;c<e;)d.push({Pa:b[c++]|b[c++]<<8,Gb:b[c++]|b[c++]<<8})};
g.Tb=function(a){if("imod"!==a.type)throw Error("invalid chunk type:"+a.type);this.Ra=this.Wa(a)};g.Sb=function(a){if("igen"!==a.type)throw Error("invalid chunk type:"+a.type);this.Qa=this.Va(a)};
g.cc=function(a){var b=this.input,c=a.offset,d=this.ra=[],e=this.nc=[],f=a.offset+a.size;if("shdr"!==a.type)throw Error("invalid chunk type:"+a.type);for(;c<f;){a=String.fromCharCode.apply(null,b.subarray(c,c+=20));var h=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var k=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var l=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var m=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var p=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var v=b[c++];var w=
b[c++]<<24>>24;var r=b[c++]|b[c++]<<8;var q=b[c++]|b[c++]<<8;var A=new Int16Array((new Uint8Array(b.subarray(this.bb.offset+2*h,this.bb.offset+2*k))).buffer);l-=h;m-=h;if(0<p){var z=this.hb(A,p);A=z.ra;p*=z.multiply;l*=z.multiply;m*=z.multiply}d.push(A);e.push({Bc:a,start:h,end:k,sc:l,zb:m,sampleRate:p,Ob:v,ec:w,Ac:r,Cc:q})}};g.hb=function(a,b){for(var c,d,e,f,h=1;b<this.sampleRate;){c=new Int16Array(2*a.length);d=f=0;for(e=a.length;d<e;++d)c[f++]=a[d],c[f++]=a[d];a=c;h*=2;b*=2}return{ra:a,multiply:h}};
g.Wa=function(a){var b=this.input,c=a.offset;a=a.offset+a.size;for(var d,e,f=[];c<a;){c+=2;d=b[c++]|b[c++]<<8;e=I[d];if(void 0===e)f.push({type:e,value:{code:d,o:b[c]|b[c+1]<<8<<16>>16,F:b[c++],B:b[c++]}});else switch(e){case "keyRange":case "velRange":case "keynum":case "velocity":f.push({type:e,value:{F:b[c++],B:b[c++]}});break;default:f.push({type:e,value:{o:b[c++]|b[c++]<<8<<16>>16}})}c+=2;c+=2}return f};
g.Va=function(a){var b=this.input,c=a.offset;a=a.offset+a.size;for(var d,e,f=[];c<a;)if(d=b[c++]|b[c++]<<8,e=I[d],void 0===e)f.push({type:e,value:{code:d,o:b[c]|b[c+1]<<8<<16>>16,F:b[c++],B:b[c++]}});else switch(e){case "keynum":case "keyRange":case "velRange":case "velocity":f.push({type:e,value:{F:b[c++],B:b[c++]}});break;default:f.push({type:e,value:{o:b[c++]|b[c++]<<8<<16>>16}})}return f};
g.pb=function(){var a=this.h,b=this.Ib,c=[],d,e;var f=0;for(d=a.length;f<d;++f){var h=a[f].Oa;var k=a[f+1]?a[f+1].Oa:b.length;var l=[];for(e=k;h<e;++h){k=this.qb(b,h);var m=this.rb(b,h);l.push({m:k.m,Bb:k.ja,i:m.i,Mb:m.ma})}c.push({name:a[f].Hb,info:l})}return c};
g.tb=function(){var a=this.gc,b=this.ic,c=[],d,e;var f=0;for(e=a.length;f<e;++f){var h=a[f].Xa;var k=a[f+1]?a[f+1].Xa:b.length;for(d=[];h<k;++h){var l=this.ub(b,h);var m=this.vb(b,h);d.push({m:l.m,Bb:l.ja,i:m.i,Mb:m.ma});l=void 0!==l.m.instrument?l.m.instrument.o:void 0!==m.i.instrument?m.i.instrument.o:null}c.push({name:a[f].hc,info:d,Na:a[f],h:l})}return c};g.qb=function(a,b){a=this.N(a[b].Pa,a[b+1]?a[b+1].Pa:this.Qa.length,this.Qa);return{m:a.T,ja:a.U}};
g.rb=function(a,b){a=this.N(a[b].oa,a[b+1]?a[b+1].Gb:this.Ra.length,this.Ra);return{i:a.T,ma:a.U}};g.ub=function(a,b){a=this.N(a[b].Ya,a[b+1]?a[b+1].Ya:this.Za.length,this.Za);return{m:a.T,ja:a.U}};g.vb=function(a,b){a=this.N(a[b].oa,a[b+1]?a[b+1].oa:this.$a.length,this.$a);return{i:a.T,ma:a.U}};g.N=function(a,b,c){var d=[],e={tc:[],keyRange:{B:127,F:0}},f;for(f=a;f<b;++f)a=c[f],d.push(a),"unknown"===a.type?e.tc.push(a.value):e[a.type]=a.value;return{T:e,U:d}};
var I=["startAddrsOffset","endAddrsOffset","startloopAddrsOffset","endloopAddrsOffset","startAddrsCoarseOffset","modLfoToPitch","vibLfoToPitch","modEnvToPitch","initialFilterFc","initialFilterQ","modLfoToFilterFc","modEnvToFilterFc","endAddrsCoarseOffset","modLfoToVolume",,"chorusEffectsSend","reverbEffectsSend","pan",,,,"delayModLFO","freqModLFO","delayVibLFO","freqVibLFO","delayModEnv","attackModEnv","holdModEnv","decayModEnv","sustainModEnv","releaseModEnv","keynumToModEnvHold","keynumToModEnvDecay",
"delayVolEnv","attackVolEnv","holdVolEnv","decayVolEnv","sustainVolEnv","releaseVolEnv","keynumToVolEnvHold","keynumToVolEnvDecay","instrument",,"keyRange","velRange","startloopAddrsCoarseOffset","keynum","velocity","initialAttenuation",,"endloopAddrsCoarseOffset","coarseTune","fineTune","sampleID","sampleModes",,"scaleTuning","exclusiveClass","overridingRootKey","endOper"];function N(a){this.b=a;this.node=this.b.createGain();this.sa=this.b.createGain();this.ha=this.b.createGain();this.g=this.b.createConvolver();this.P=this.b.createBiquadFilter();this.aa=350;this.va=2;this.gb=0;this.wa="lowpass";this.xa=1;this.ba=!1;this.ya=3;this.g.connect(this.ha);this.g.connect(this.sa);this.g.connect(this.P);this.ha.connect(this.g);this.sa.connect(this.g);this.P.connect(this.g);for(var b in void 0)void 0!==(void 0)[b]&&(this["_"+b]=(void 0)[b]);this.Kb(this.xa);this.Ab(this.wa);
this.wb(this.aa);this.Y()}g=N.prototype;g.node=function(){this.node.gain.setTargetAtTime(100,this.b.currentTime,.015);return this.g};
g.Y=function(){var a=this.b.sampleRate,b=Math.max(a*this.ya,1),c=a*this.gb;a=this.b.createBuffer(2,b,a);for(var d=new Float32Array(b),e=new Float32Array(b),f=0;f<b;f++){if(f<c)d[f]=0,e[f]=0;else{var h=this.ba?b-f:f;h=Math.pow(1-h/b,this.va);d[f]=(2*Math.random()-1)*h;e[f]=(2*Math.random()-1)*h}h=this.ba?b-(f-c):f-c;h=Math.pow(1-h/b,this.va);d[f]=(2*Math.random()-1)*h;e[f]=(2*Math.random()-1)*h}a.getChannelData(0).set(d);a.getChannelData(1).set(e);console.info("Update impulse responce.");this.g.buffer=
a};g.connect=function(a){y.console.info("Connect Reverb.");this.g.connect(a.input?a.input:a)};g.disconnect=function(a){y.console.info("Disconnect Reverb.");this.g.disconnect(a)};g.Kb=function(a){this.xa=a;this.ha.gain.setTargetAtTime(this.Db(a)/127,this.b.currentTime,.015);this.sa.gain.setTargetAtTime(this.Fb(a)/127,this.b.currentTime,.015)};g.time=function(a){this.ya=a;this.Y()};g.reverse=function(a){this.ba=a;this.Y()};
g.wb=function(a){this.aa=a;this.P.frequency.setTargetAtTime(this.aa,this.b.currentTime,.015)};g.Ab=function(a){this.P.type=this.wa=a};g.Db=function(a){return 1<a||0>a?0:.5>=a?1:1-2*(a-.5)};g.Fb=function(a){return 1<a||0>a?0:.5<=a?1:1-2*(a-.5)};var O="Acoustic Piano;Bright Acoustic Piano;Electric Grand Piano;Honky-tonk Piano;Electric Piano;Electric Piano 2;Harpsichord;Clavi;Celesta;Glockenspiel;Musical box;Vibraphone;Marimba;Xylophone;Tubular Bell;Dulcimer;Drawbar Organ;Percussive Organ;Rock Organ;Church organ;Reed organ;Accordion;Harmonica;Tango Accordion;Acoustic Guitar (nylon);Acoustic Guitar (steel);Electric Guitar (jazz);Electric Guitar (clean);Electric Guitar (muted);Overdriven Guitar;Distortion Guitar;Guitar Harmonics;Acoustic Bass;Electric Bass (finger);Electric Bass (pick);Fretless Bass;Slap Bass 1;Slap Bass 2;Synth Bass 1;Synth Bass 2;Violin;Viola;Cello;Double bass;Tremolo Strings;Pizzicato Strings;Orchestral Harp;Timpani;String Ensemble 1;String Ensemble 2;Synth Strings 1;Synth Strings 2;Voice Aahs;Voice Oohs;Synth Voice;Orchestra Hit;Trumpet;Trombone;Tuba;Muted Trumpet;French horn;Brass Section;Synth Brass 1;Synth Brass 2;Soprano Sax;Alto Sax;Tenor Sax;Baritone Sax;Oboe;English Horn;Bassoon;Clarinet;Piccolo;Flute;Recorder;Pan Flute;Blown Bottle;Shakuhachi;Whistle;Ocarina;Lead 1 (square);Lead 2 (sawtooth);Lead 3 (calliope);Lead 4 (chiff);Lead 5 (charang);Lead 6 (voice);Lead 7 (fifths);Lead 8 (bass + lead);Pad 1 (new age);Pad 2 (warm);Pad 3 (polysynth);Pad 4 (choir);Pad 5 (bowed);Pad 6 (metallic);Pad 7 (halo);Pad 8 (sweep);FX 1 (rain);FX 2 (soundtrack);FX 3 (crystal);FX 4 (atmosphere);FX 5 (brightness);FX 6 (goblins);FX 7 (echoes);FX 8 (sci-fi);Sitar;Banjo;Shamisen;Koto;Kalimba;Bagpipe;Fiddle;Shanai;Tinkle Bell;Agogo;Steel Drums;Woodblock;Taiko Drum;Melodic Tom;Synth Drum;Reverse Cymbal;Guitar Fret Noise;Breath Noise;Seashore;Bird Tweet;Telephone Ring;Helicopter;Applause;Gunshot".split(";"),
P=["Standard Set",null,null,null,null,null,null,null,"Room Set",null,null,null,null,null,null,null,"Power Set",null,null,null,null,null,null,null,"Electronic Set","Analog Set",null,null,null,null,null,null,"Jazz Set",null,null,null,null,null,null,null,"Brush Set",null,null,null,null,null,null,null,"Orchestra Set",null,null,null,null,null,null,null,"SFX Set",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,
null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];function Q(a){var b;this.input=a;this.na={};this.za=0;this.L={};this.bufferSize=2048;this.b=this.Cb();this.u=this.b.createGain();this.ca=this.b.createBufferSource();this.j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.Ha=[127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127];this.Ea=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.Fa=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.ea=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2];this.da=[127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127];this.Ga=
[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.M=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];this.w=[0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0];this.ob=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.ab=[40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40];this.Ma=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.ga=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.D=this.S=!1;this.Da=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];this.l=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];this.lb=
1/65535;this.V=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];this.G=Array(128);a=0;for(b=this.G.length;a<b;++a)this.G[a]=127;this.qa=new N(this.b)}g=Q.prototype;g.Cb=function(){if(void 0!==y.AudioContext)var a=new y.AudioContext;else if(void 0!==y.webkitAudioContext)a=new y.webkitAudioContext;else if(void 0!==y.mozAudioContext)a=new y.mozAudioContext;else throw Error("Web Audio not supported");void 0===a.createGainNode&&(a.createGainNode=a.createGain);return a};
g.R=function(){var a;this.na=new H(this.input,{sampleRate:this.b.sampleRate});this.L=this.Ia();this.S=this.D=!1;for(a=0;16>a;++a)this.pa(a,0),this.fb(a,100),this.Ua(a,64),this.H(a,0,64),this.I(a,2),this.M[a]=!1,this.da[a]=127,this.Ba(a,9===a?128:0),this.Aa(a,0),this.f(a,!1),this.qc(a);for(a=0;128>a;++a)this.G[a]=127};g.close=function(){this.b.close()};g.kc=function(a){this.input=a;this.na=new H(a);this.L=this.Ia()};
g.Ia=function(){var a=this.na;a.parse();var b=a.tb(),c=a.pb(),d=[],e,f;var h=0;for(e=b.length;h<e;++h){var k=b[h];var l=k.Na.fc;var m=k.Na.za;if("number"==typeof k.h){var p=c[k.h];if("EOI"!==p.name.replace(/\0*$/,""))for(void 0===d[m]&&(d[m]=[]),m=d[m],m[l]={},m[l].name=k.name,k=0,f=p.info.length;k<f;++k)this.sb(a,p.info[k],m[l])}}return d};
g.sb=function(a,b,c){b=b.m;var d;if(void 0!==b.keyRange&&void 0!==b.sampleID){var e=this.a(b,"delayVolEnv",-12E3);var f=this.a(b,"attackVolEnv",-12E3);var h=this.a(b,"holdVolEnv",-12E3);var k=this.a(b,"decayVolEnv",-12E3);var l=this.a(b,"sustainVolEnv");var m=this.a(b,"releaseVolEnv",-12E3);var p=this.a(b,"delayModEnv",-12E3);var v=this.a(b,"attackModEnv",-12E3);var w=this.a(b,"holdModEnv",-12E3);var r=this.a(b,"decayModEnv",-12E3);var q=this.a(b,"sustainModEnv");var A=this.a(b,"releaseModEnv",-12E3);
var z=this.a(b,"coarseTune")+this.a(b,"fineTune")/100;var J=this.a(b,"scaleTuning",100)/100;var K=this.a(b,"freqVibLFO");var L=this.a(b,"pan");var t=b.keyRange.F;for(d=b.keyRange.B;t<=d;++t)if(!c[t]){var M=this.a(b,"sampleID");var B=a.nc[M];c[t]={sample:a.ra[M],sampleRate:B.sampleRate,sampleModes:this.a(b,"sampleModes"),basePlaybackRate:Math.pow(Math.pow(2,1/12),(t-this.a(b,"overridingRootKey",B.Ob)+z+B.ec/100)*J),modEnvToPitch:this.a(b,"modEnvToPitch")/100,scaleTuning:J,start:32768*this.a(b,"startAddrsCoarseOffset")+
this.a(b,"startAddrsOffset"),end:32768*this.a(b,"endAddrsCoarseOffset")+this.a(b,"endAddrsOffset"),loopStart:B.sc+32768*this.a(b,"startloopAddrsCoarseOffset")+this.a(b,"startloopAddrsOffset"),loopEnd:B.zb+32768*this.a(b,"endloopAddrsCoarseOffset")+this.a(b,"endloopAddrsOffset"),volDelay:Math.pow(2,e/1200),volAttack:Math.pow(2,f/1200),volHold:Math.pow(2,h/1200)*Math.pow(2,(60-t)*this.a(b,"keynumToVolEnvHold")/1200),volDecay:Math.pow(2,k/1200)*Math.pow(2,(60-t)*this.a(b,"keynumToVolEnvDecay")/1200),
volSustain:l/1E3,volRelease:Math.pow(2,m/1200),modDelay:Math.pow(2,p/1200),modAttack:Math.pow(2,v/1200),modHold:Math.pow(2,w/1200)*Math.pow(2,(60-t)*this.a(b,"keynumToModEnvHold")/1200),modDecay:Math.pow(2,r/1200)*Math.pow(2,(60-t)*this.a(b,"keynumToModEnvDecay")/1200),modSustain:q/1E3,modRelease:Math.pow(2,A/1200),initialFilterFc:this.a(b,"initialFilterFc",13500),modEnvToFilterFc:this.a(b,"modEnvToFilterFc"),initialFilterQ:this.a(b,"initialFilterQ"),reverbEffectSend:this.a(b,"reverbEffectSend"),
initialAttenuation:this.a(b,"initialAttenuation"),freqVibLFO:K?8.176*Math.pow(2,K/1200):void 0,pan:L?L/1200:void 0}}}};g.a=function(a,b,c){void 0===c&&(c=0);return a[b]?a[b].o:c};g.start=function(){this.connect();this.W(16383);this.ca.start(0)};g.W=function(a){this.u.gain.setTargetAtTime(a/16384*this.lb,this.b.currentTime,.015)};g.connect=function(){this.J(!0);this.ca.connect(this.u);this.u.connect(this.b.destination)};g.disconnect=function(){this.J(!1);this.ca.disconnect(0);this.u.disconnect(0)};
g.J=function(a){a?(this.u.connect(this.qa.node),this.qa.connect(this.b.destination)):this.qa.disconnect(0)};g.qc=function(a){this.ab[a]=40};var R="Mute Instrument Vol Panpot Pitch  Mode".split(" ");g=Q.prototype;
g.xb=function(){const a=y.window.document,b=a.createElement("div"),c=a.createElement("div");c.className="instrument";const d="mute program volume panpot pitchBend pitchBendSensitivity keys".split(" ");var e=a.createElement("div");e.className="instrument header";for(var f in d){var h=a.createElement("div");h.className="keys"!==d[f]?d[f]:"mode";h.innerText=R[f];e.appendChild(h)}b.appendChild(e);for(f=0;16>f;f++){e=a.createElement("div");e.className="channel";for(let b in d){h=a.createElement("div");
h.className=d[b];switch(d[b]){case "mute":h.className+=" custom-control custom-checkbox custom-control-inline";var k=a.createElement("input");k.setAttribute("type","checkbox");k.className="custom-control-input";k.id="mute"+f+"ch";k.addEventListener("change",function(a,b){return function(){a.Nb(b,this.checked)}}(this,f),!1);h.appendChild(k);k=a.createElement("label");k.className="custom-control-label";k.setAttribute("for","mute"+f+"ch");h.appendChild(k);break;case "program":k=a.createElement("select");
k.className="custom-select custom-select-sm";var l=9!==f?O:P;for(let b in l){let c=a.createElement("option");l[b]&&(c.textContent=("000"+(parseInt(b)+1)).slice(-3)+" :"+l[b],c.value=b,k.appendChild(c))}h.appendChild(k);k.addEventListener("change",function(a,b){return function(c){a.pa(b,c.target.value)}}(this,f),!1);k.selectedIndex=this.j[b];break;case "volume":h.innerText=100;case "pitchBendSensitivity":h.innerText=2;break;case "panpot":k=a.createElement("meter");k.min=0;k.max=127;k.value=64;h.appendChild(k);
break;case "pitchBend":k=a.createElement("meter");k.min=-8192;k.max=8192;k.value=0;h.appendChild(k);break;case "keys":for(k=0;127>k;k++)l=a.createElement("div"),l.className="key "+([1,3,6,8,10].includes(k%12)?"semitone":"tone"),h.appendChild(l),l.addEventListener("mousedown",function(a,b,c){return function(d){d.preventDefault();a.Ka=!0;a.noteOn(b,c,127)}}(this,f,k)),l.addEventListener("mouseover",function(a,b,c){return function(d){d.preventDefault();a.Ka&&a.noteOn(b,c,127)}}(this,f,k)),l.addEventListener("mouseout",
function(a,b,c){return function(d){d.preventDefault();a.noteOff(b,c,0)}}(this,f,k)),l.addEventListener("mouseup",function(a,b,c){return function(d){d.preventDefault();a.Ka=!1;a.noteOff(b,c,0)}}(this,f,k))}e.appendChild(h)}c.appendChild(e)}b.appendChild(c);return b};
g.noteOn=function(a,b,c){var d=this.La(a),e=this.L[d][this.j[a]];void 0===e&&(e=this.L[0][this.j[a]],y.console.warn("instrument not found: bank=%s instrument=%s channel=%s",d,this.j[a],a));if(void 0===e[b])y.console.warn("instrument not found: bank=%s instrument=%s channel=%s key=%s",d,this.j[a],a,b);else{d=e[b];var f=this.Ea[a]-64;d.channel=a;d.key=b;d.velocity=c;d.panpot=f/(0>f?64:63);d.volume=this.Ha[a]/127;d.pitchBend=this.Fa[a]-8192;d.expression=this.da[a];d.pitchBendSensitivity=Math.round(this.ea[a]);
d.mute=this.Da[a];d.releaseTime=this.Ga[a];d.cutOffFrequency=this.ga[a];d.harmonicContent=this.Ma[a];this.V[a]&&(42!==b&&44!==b||this.noteOff(a,46,0),80===b&&this.noteOff(a,81,0),e.volume*=this.G[b]/127);e=new E(this.b,this.u,d);e.noteOn();this.l[a].push(e);this.eb(a,b,c)}};g.noteOff=function(a,b){this.La(a);var c,d=this.l[a],e=this.M[a];var f=0;for(c=d.length;f<c;++f){var h=d[f];h.key===b&&(h.noteOff(),e||(h.release(),d.splice(f,1),--f,--c))}this.eb(a,b,0)};
g.eb=function(a,b,c){b=document.querySelector(".instrument > .channel:nth-child("+(a+1)+") > .keys >.key:nth-child("+(b+1)+")");0===c?b.classList.remove("note-on"):b.classList.add("note-on");this.M[a]?document.querySelector(".instrument > .channel:nth-child("+(a+1)+")").classList.add("hold"):document.querySelector(".instrument > .channel:nth-child("+(a+1)+")").classList.remove("hold")};
g.ka=function(a,b){var c=this.l[a],d;if(!(this.M[a]=!(64>b)))for(b=0,d=c.length;b<d;++b)a=c[b],a.Ta&&(a.release(),c.splice(b,1),--b,--d)};g.Ba=function(a,b){this.w[a]=b};g.Aa=function(a,b){this.ob[a]=b};g.pa=function(a,b){document.querySelector(".instrument > .channel:nth-child("+(a+1)+") > .program > select").value=b;this.j[a]=b};g.fb=function(a,b){document.querySelector(".instrument > .channel:nth-child("+(a+1)+") > .volume").innerText=b;this.Ha[a]=b};
g.A=function(a,b){var c,d=this.l[a];var e=0;for(c=d.length;e<c;++e)d[e].uc(b);this.da[a]=b};g.Ua=function(a,b){document.querySelector(".instrument > .channel:nth-child("+(a+1)+") > .panpot > meter").value=b;this.Ea[a]=b};g.H=function(a,b,c){b=b&127|(c&127)<<7;var d,e=this.l[a],f=b-8192;document.querySelector(".instrument > .channel:nth-child("+(a+1)+") > .pitchBend > meter").value=f;c=0;for(d=e.length;c<d;++c)e[c].cb(f);this.Fa[a]=b};
g.I=function(a,b){document.querySelector(".instrument > .channel:nth-child("+(a+1)+") > .pitchBendSensitivity").innerText=b;this.ea[a]=b};g.lc=function(a,b){this.Ga[a]=b};g.Eb=function(a){return this.ea[a]};g.yb=function(a,b){this.G[a]=b};g.ib=function(a){var b=this.l[a];for(this.ka(a,0);0<b.length;)this.noteOff(a,b[0].key,0)};g.jb=function(a){for(var b=this.l[a],c;0<b.length;)c=b.shift(),this.noteOff(a,c.key,0),c.release(),c.disconnect();this.ka(a,0)};
g.mc=function(a){this.ib(a);this.A(a,127);this.H(a,0,64)};g.Nb=function(a,b){var c=this.l[a];if(this.Da[a]=b)for(a=0,b=c.length;a<b;++a)c[a].disconnect();else for(a=0,b=c.length;a<b;++a)c[a].connect()};
g.La=function(a){var b="GM Mode";if(9===a)return this.f(9,!0),this.D?127:128;if(this.D){b="XG Mode";var c=64===this.w[a]?125:126===this.w[a]||127===this.w[a]?this.w[a]:0}else this.S?(b="GS Mode",c=0,this.V[a]&&(c=128)):c=0;this.V[a]&&void 0===P[this.j[a]]&&(this.j[a]=0);document.querySelector(".header div:last-child").innerText=b;return c};g.f=function(a,b){this.V[a]=b};function S(a){this.ua=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.ta=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.$=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.ready=!1;this.la=function(){};this.Jb=this.onmessage.bind(this);this.v=!0;this.Ja=void 0!==a.Ja;this.cache=void 0!==a.cache;this.placeholder=void 0!==a.placeholder?y.document.getElementById(a.placeholder):y.window.document.body;y.window.addEventListener("DOMContentLoaded",function(){this.ready=!0}.bind(this),!1)}
g=S.prototype;g.rc=function(a){var b=y.window;this.ready?this.load(a):b.addEventListener("DOMContentLoaded",function d(){b.removeEventListener("DOMContentLoaded",d,!1);this.load(a)}.bind(this),!1);b.opener?this.opener=b.opener:b.parent!==b&&(this.opener=b.parent)};
g.load=function(a){var b=y.window.opener?y.window.opener:y.window.parent,c=this,d=this.placeholder.appendChild(document.createElement("progress")),e=d.parentNode.insertBefore(document.createElement("outpout"),d.nextElementSibling);fetch(a).then((a)=>{const f=a.headers.get("content-length");d.max=f;let k=a.body.getReader(),l=0,m=[];k.read().then(function w(a){if(a.done){var h=0;for(a=0;a<m.length;++a)h+=m[a].byteLength;h=new Uint8Array(h);var q=0;for(a=0;a<m.length;++a)h.set(new Uint8Array(m[a]),q),
q+=m[a].byteLength;a=h.buffer;c.placeholder.removeChild(d);c.placeholder.removeChild(e);c.onload(a);"function"==C(c.la)&&c.la(a)}else return l+=a.value.length,m.push(a.value),d.value=l,e.innerText=Math.round(l/f*100)+" %",b.postMessage("link,progress,"+l+","+f,"*"),k.read().then(w)})})};g.J=function(a){this.X.J(a)};g.nb=function(){};g.onload=function(a){a=new Uint8Array(a);this.Sa(a)};
g.Sa=function(a){var b=y.window;if(this.X){var c=this.X;c.kc(a)}else c=this.X=new Q(a),this.Ja||this.placeholder.appendChild(c.xb()),c.R(),c.start(),b.addEventListener("message",this.Jb,!1);b.postMessage("link,ready","*")};
g.onmessage=function(a){var b="function"==C(a.data.split)?a.data.split(","):[],c=b!==[]?b.shift():"";a=y.window.opener?y.window.opener:y.window.parent;switch(c){case "midi":this.jc(b.map(function(a){return parseInt(a,16)}));break;case "link":if(void 0!==a)switch(b=b.shift(),b){case "reqpatch":a.postMessage("link,patch","*");break;case "setpatch":case "ready":a.postMessage("link,ready","*");break;case "progress":a.postMessage("link,progress","*");break;default:y.console.error("unknown link message:",
b)}}};g.pc=function(a){this.la=a};
g.jc=function(a){var b=a[0]&15,c=this.X;switch(a[0]&240){case 128:c.noteOff(b,a[1],a[2]);break;case 144:0<a[2]?c.noteOn(b,a[1],a[2]):c.noteOff(b,a[1],0);break;case 176:var d=a[2];switch(a[1]){case 0:c.Ba(b,d);break;case 6:if(this.v)switch(this.$[b]){case 0:switch(this.Z[b]){case 0:c.I(b,d)}}else switch(this.ua[b]){case 26:c.yb(this.ta[b],d)}break;case 38:if(this.v)switch(this.$[b]){case 0:switch(this.Z[b]){case 0:c.I(b,c.Eb(b)+d/100)}}break;case 7:c.fb(b,d);break;case 10:c.Ua(b,d);break;case 120:c.jb(b);
break;case 121:c.mc(b);break;case 32:c.Aa(b,d);break;case 98:this.v=!1;this.ta[b]=d;break;case 99:this.v=!1;this.ua[b]=d;break;case 100:this.v=!0;this.Z[b]=d;break;case 101:this.v=!0;this.$[b]=d;break;case 64:c.ka(b,d);break;case 11:c.A(b,d);break;case 71:c.ga[b]=d;break;case 72:c.wc[b]=d;break;case 73:c.lc(b,d);break;case 74:c.Ma[b]=d;break;case 91:c.ab[b]=d}break;case 192:c.pa(b,a[1]);break;case 224:c.H(b,a[1],a[2]);break;case 240:switch(a[1]){case 126:127===a[2]&&9===a[3]&&1===a[4]&&(c.D=!1,c.S=
!1,c.R());break;case 127:switch(a[3]){case 4:switch(a[4]){case 1:c.W(a[5]+(a[6]<<7))}}}switch(a[2]){case 67:8===a[5]&&(0!==a[7]?c.f(a[6],!0):c.f(a[6],!1));switch(a[7]){case 4:c.W(2*(a[8]<<7));break;case 126:c.R(),c.D=!0}break;case 65:switch(a[8]){case 4:c.W(a[9]<<7);break;case 127:c.R();c.S=!0;break;case 21:b=a[7]-15,a=a[8],0===b?0!==a?c.f(9,!0):c.f(9,!1):10<=b?0!==a?c.f(b-1,!0):c.f(b-1,!1):0!==a?c.f(b,!0):c.f(b,!1)}}break;default:c.f(9,!0)}};D("SoundFont.WebMidiLink",S);D("SoundFont.WebMidiLink.prototype.setup",S.prototype.rc);D("SoundFont.WebMidiLink.prototype.loadSoundFont",S.prototype.Sa);D("SoundFont.WebMidiLink.prototype.cancelLoading",S.prototype.nb);D("SoundFont.WebMidiLink.prototype.setLoadCallback",S.prototype.pc);D("SoundFont.WebMidiLink.prototype.setReverb",S.prototype.J);}).call(this); //# sourceMappingURL=sf2synth.min.js.map
